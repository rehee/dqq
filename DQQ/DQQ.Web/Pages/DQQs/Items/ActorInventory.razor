@using DQQ.Profiles.Items.Equipments
@using DQQ.Helper
@using DQQ.Web.Pages.DQQs.Items.Components
@inherits ActorInventoryPage
<h3>背包 <button type="button" class="btn btn-primary" @onclick="@OpenDrawer">汇总</button></h3>
<Layout ShowFooter="true">
	<Header>
		<div>
			<EquipInSlot Equips="SelectedCharacter?.EquipItems" OnDismiss="()=>UnEquipSlog(EnumEquipSlot.Head)" Slots="EnumEquipSlot.Head" />
			<EquipInSlot Equips="SelectedCharacter?.EquipItems" OnDismiss="()=>UnEquipSlog(EnumEquipSlot.Body)" Slots="EnumEquipSlot.Body" />
			<EquipInSlot Equips="SelectedCharacter?.EquipItems" OnDismiss="()=>UnEquipSlog(EnumEquipSlot.Gloves)" Slots="EnumEquipSlot.Gloves" />
			<EquipInSlot Equips="SelectedCharacter?.EquipItems" OnDismiss="()=>UnEquipSlog(EnumEquipSlot.Boots)" Slots="EnumEquipSlot.Boots" />
			<EquipInSlot Equips="SelectedCharacter?.EquipItems" OnDismiss="()=>UnEquipSlog(EnumEquipSlot.MainHand)" Slots="EnumEquipSlot.MainHand" />
			<EquipInSlot Equips="SelectedCharacter?.EquipItems" OnDismiss="()=>UnEquipSlog(EnumEquipSlot.OffHand)" Slots="EnumEquipSlot.OffHand" />
			<EquipInSlot Equips="SelectedCharacter?.EquipItems" OnDismiss="()=>UnEquipSlog(EnumEquipSlot.Amulet)" Slots="EnumEquipSlot.Amulet" />
			<EquipInSlot Equips="SelectedCharacter?.EquipItems" OnDismiss="()=>UnEquipSlog(EnumEquipSlot.Belt)" Slots="EnumEquipSlot.Belt" />
			<EquipInSlot Equips="SelectedCharacter?.EquipItems" OnDismiss="()=>UnEquipSlog(EnumEquipSlot.LeftRing)" Slots="EnumEquipSlot.LeftRing" />
			<EquipInSlot Equips="SelectedCharacter?.EquipItems" OnDismiss="()=>UnEquipSlog(EnumEquipSlot.RightRing)" Slots="EnumEquipSlot.RightRing" />
		</div>
		<div>

			<Drawer Placement="Placement.Left" @bind-IsOpen="@IsBackdropOpen" IsBackdrop="true">
				<p class="mt-3 text-center">
					属性汇总
				</p>
			</Drawer>
		</div>
	</Header>

	<Main>
		<div style="overflow:hidden;height: calc(100vh - 300px);">
			@if (Items != null)
			{
				foreach (var item in Items)
				{
					var equip = item.Profile as EquipProfile;
					<p>
						@item.Name
						@if (item?.Profile?.IsStack == true)
						{
							<span>(@item?.Quantity)</span>
						}
						@if (equip != null)
						{
							var slots = EquiptableHelper.GetAvaliableSlots(equip.EquipType);

							if (slots?.Count() > 1)
							{
								foreach (var slot in slots)
								{
									<Button Color="Color.Success" Text="@($"装备 ({slot})")" OnClick="()=>EquipItem(item?.Id,slot)" />
								}
							}
							else
							{
								<Button Color="Color.Success" Text="装备" OnClick="()=>EquipItem(item?.Id,null)" />
							}
						}
					</p>
				}
			}

		</div>
	</Main>
	<Footer>
		<div>物品数量: xxx 物品上限: yyy 剩余: (yyy-xxx)</div>
	</Footer>
</Layout>
