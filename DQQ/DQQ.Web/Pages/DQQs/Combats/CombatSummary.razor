@using DQQ.Web.Resources.Monsters
@inherits CombatSummaryPage
<Card>
	<HeaderTemplate>
		战斗
	</HeaderTemplate>
	<BodyTemplate>
		<div>
			<BootstrapInputGroupLabel DisplayText="选择地图" />
			<Select Items="UnlockedMaps?.GetSelectedItemEnum()" @bind-Value="SelectedMap">
			</Select>
		</div>
	</BodyTemplate>
</Card>

<Card>
	<HeaderTemplate>
		地图详情
		<DQQInfo>
			<h4>
				怪物详情
			</h4>
			@if (SelectedMapProfile != null)
			{
				foreach (var m in SelectedMapProfile?.MobNumbers!)
				{
					var momster = m.GetMomster();
					<Card>
						<HeaderTemplate>
							@momster?.Name
						</HeaderTemplate>
						<BodyTemplate>
							<div class="row g-3">
								<div class="col-auto col-form-label">
									<span>血量百分比</span>
									<span>
										<Popover Trigger="click" Content="怪物的基础血量. 百分比越高则血量越高">
											<i class="fas fa-circle-info"></i>
										</Popover>
									</span>
								</div>
								<div class="col-auto">
									<Display TValue="double?" Value="@momster?.HPPercentage" />
								</div>
							</div>
							<div class="row g-3">
								<div class="col-auto col-form-label">
									<span>伤害百分比</span>
									<span>
										<Popover Trigger="click" Content="怪物的基础伤害. 百分比越高则造成的伤害越高">
											<i class="fas fa-circle-info"></i>
										</Popover>
									</span>
								</div>
								<div class="col-auto">
									<Display TValue="double?" Value="@momster?.DamagePercentage" />
								</div>
							</div>
							<h5>技能</h5>
							<div class="row g-3">
								@foreach (var s in momster!.Skills)
								{
									<div class="col-auto">
										<Tag>
											@s.Profile?.Name
										</Tag>
										<Popover Trigger="click" Content="@s.Profile?.ExtureDiscription" IsHtml="true">
											<i class="fas fa-circle-info"></i>
										</Popover>
									</div>
								}
							</div>
							@(new MarkupString(momster?.ExtureDiscription ?? ""))
						</BodyTemplate>
					</Card>

				}
			}

		</DQQInfo>
	</HeaderTemplate>
	<BodyTemplate>
		@if (SelectedMapProfile != null)
		{
			<div>
				@SelectedMapProfile?.Discription
			</div>
			<div class="row g-3">
				<div class="col-auto col-form-label">
					<span>战斗时间限制(秒)</span>
				</div>
				<div class="col-auto">
					<Display TValue="int?" Value="@SelectedMapProfile?.MaxCombatSecond" />
				</div>
			</div>
			<div class="row g-3">
				<div class="col-auto col-form-label">
					<span>小怪波次</span>
				</div>
				<div class="col-auto">
					<Display TValue="int?" Value="@SelectedMapProfile?.TrashWave" />
				</div>
			</div>
			<div class="row g-3">
				<div class="col-auto col-form-label">
					<span>首领波次</span>
				</div>
				<div class="col-auto">
					<Display TValue="int?" Value="@SelectedMapProfile?.BossWave" />
				</div>
			</div>
			<div class="row g-3">
				<div class="col-auto col-form-label">
					<span>每个波次最小敌人数目</span>
				</div>
				<div class="col-auto">
					<Display TValue="int?" Value="@SelectedMapProfile?.TrashMinMob" />
				</div>
			</div>
			<div class="row g-3">
				<div class="col-auto col-form-label">
					<span>每个波次最多敌人数目</span>
				</div>
				<div class="col-auto">
					<Display TValue="int?" Value="@SelectedMapProfile?.TrashMaxMob" />
				</div>
			</div>

			<h5>可能出现的敌人</h5>
			<div class="row g-3">

				@foreach (var m in SelectedMapProfile?.MobNumbers!)
				{
					<Tag class="col-auto">
						@m.GetMomster()?.Name
					</Tag>
				}
			</div>
			<h5>可能出现的首领</h5>
			<div class="row g-3">

				@foreach (var m in SelectedMapProfile?.BossNumbers!)
				{
					<Tag class="col-auto">
						@m.GetMomster()?.Name
					</Tag>
				}
			</div>
		}
	</BodyTemplate>
</Card>
<Card>
	<BodyTemplate>
		<div>
			@if (SelectedMap != null)
			{
				<Button IsAsync="true" class="btn" Color="Color.Danger" Text="@(Clicked==true?"稍等片刻":"开始战斗")" OnClick="CombatRequest5" />
			}
		</div>
	</BodyTemplate>
</Card>
